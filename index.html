<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Enhanced Fullscreen WebSim</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: Arial, sans-serif;
    background: #f0f0f0;
  }

  /* Button to open popup */
  #openPopupButton {
    display: inline-block;
    padding: 12px 24px;
    margin: 40px;
    font-size: 18px;
    background: #007BFF;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: 0.3s;
  }

  #openPopupButton:hover {
    background: #0056b3;
  }

  /* Fullscreen overlay */
  #popupOverlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.4s ease, visibility 0.4s ease;
    z-index: 1000;
  }

  #popupOverlay.active {
    opacity: 1;
    visibility: visible;
  }

  #popupWindow {
    width: 95%;
    max-width: 1200px;
    height: 90%;
    background: #fff;
    border-radius: 12px;
    overflow: hidden;
    position: relative;
    box-shadow: 0 0 30px rgba(0,0,0,0.6);
    transform: scale(0.8);
    transition: transform 0.3s ease;
  }

  #popupOverlay.active #popupWindow {
    transform: scale(1);
  }

  #closeButton {
    position: absolute;
    top: 12px;
    right: 20px;
    background: #f44336;
    color: #fff;
    border: none;
    padding: 6px 12px;
    cursor: pointer;
    border-radius: 6px;
    font-size: 16px;
    z-index: 1100;
    transition: 0.3s;
  }

  #closeButton:hover {
    background: #c0392b;
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>

<button id="openPopupButton">Open WebSim in Fullscreen</button>

<div id="popupOverlay">
  <div id="popupWindow">
    <button id="closeButton">Close</button>
    <iframe id="websimIframe"
      src="https://aqeeda.on.websim.com/"
      sandbox="allow-scripts allow-same-origin allow-popups allow-forms allow-modals"
      allowfullscreen
      ></iframe>
  </div>
</div>

<script>
  const overlay = document.getElementById('popupOverlay');
  const openBtn = document.getElementById('openPopupButton');
  const closeBtn = document.getElementById('closeButton');
  const iframe = document.getElementById('websimIframe');

  function openPopup() {
    overlay.classList.add('active');

    // Request fullscreen on popupWindow for best results
    const el = document.getElementById('popupWindow');
    if (el.requestFullscreen) el.requestFullscreen();
    else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    else if (el.msRequestFullscreen) el.msRequestFullscreen();
  }

  function closePopup() {
    overlay.classList.remove('active');
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
    else if (document.msExitFullscreen) document.msExitFullscreen();
  }

  // Close on overlay click (outside popupWindow)
  overlay.addEventListener('click', (e) => {
    if (e.target === overlay) closePopup();
  });

  // Close on ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closePopup();
  });

  openBtn.addEventListener('click', openPopup);
  closeBtn.addEventListener('click', closePopup);

  // Optional: auto-open if user logged in
  if (localStorage.getItem('websimLoggedIn')) {
    openBtn.click();
  }
</script>

</body>
</html>
